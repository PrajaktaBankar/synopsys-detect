(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"42Vr":function(t,e,o){"use strict";o.r(e),o.d(e,"NotebookModule",(function(){return mt}));var a=o("PCNd"),i=o("+0xr"),r=o("XNiG"),n=o("1G5W"),s=o("3Pt+"),c=o("0IaG"),b=o("fXoL"),l=o("kYjS"),u=o("5eHb"),d=o("mLz/"),p=o("AytR"),h=o("tk/3");let m=(()=>{class t{constructor(t){this._http=t,this.serverBaseUrl=p.a.serverBaseUrl,this.formData=new FormData}getAllNotebooks(t){return this._http.get(`${this.serverBaseUrl}/api/projects/${t}/notebooks`)}deleteNotebook(t,e,o){return this._http.delete(`${this.serverBaseUrl}/api/projects/${t}/notebook/${e}/delete/${o}`)}createNewNotebook(t,e){return this._http.post(`${this.serverBaseUrl}/api/projects/${t}/notebook/save`,e)}}return t.\u0275fac=function(e){return new(e||t)(b.Xb(h.b))},t.\u0275prov=b.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=o("ofXK"),k=o("kmnG"),g=o("qFsG"),S=o("d3UM"),w=o("bSwM"),N=o("bTqV"),I=o("/3uh"),v=o("FKr1"),T=o("8NN1");function _(t,e){1&t&&b.Ob(0,"app-progress-spinner",19)}function y(t,e){1&t&&(b.Tb(0,"mat-error"),b.Kc(1,"Notebook name is required."),b.Sb())}function F(t,e){1&t&&(b.Tb(0,"mat-error"),b.Kc(1,"Only alphanumeric characters are allowed."),b.Sb())}function D(t,e){if(1&t&&(b.Tb(0,"mat-option",20),b.Kc(1),b.fc(2,"dropFileExtension"),b.Sb()),2&t){const t=e.$implicit;b.kc("value",t),b.Bb(1),b.Lc(b.hc(2,2,t.name,t.fileSource))}}function B(t,e){1&t&&(b.Tb(0,"mat-error"),b.Kc(1,"Input file is required."),b.Sb())}function O(t,e){if(1&t&&(b.Tb(0,"mat-option",20),b.Kc(1),b.Sb()),2&t){const t=e.$implicit;b.kc("value",t._id),b.Bb(1),b.Lc(t.name)}}function C(t,e){1&t&&(b.Tb(0,"mat-error"),b.Kc(1,"Folder is required."),b.Sb())}const K=function(){return{standalone:!0}};let $=(()=>{class t{constructor(t,e,o,a,i,n,c){this.dialogData=t,this._fb=e,this._data=o,this._toaster=a,this._notebookDialogRef=i,this._localStorage=n,this._notebook=c,this.unsubscribe$=new r.b,this.showSpinner=!1,this.addToPipeline=!1,this.notebookForm=this._fb.group({fileName:["",[s.I.required,s.I.pattern("^[^\\s][A-Za-z0-9_ ]+$")]],inputFiles:["",s.I.nullValidator],outputFileDataGroupId:["",s.I.nullValidator]})}ngOnInit(){this.project=this._localStorage.getItem("project")}onSubmitNotebook(t){this.showSpinner=!0;let e={projectPath:"",fileName:`${t.fileName}-${Date.now()}.ipynb`,inputFile:t.inputFiles.name,notebookInputFileId:t.inputFiles._id,outputFileDataGroupId:t.outputFileDataGroupId,addToPipeline:this.addToPipeline,projectId:this.project._id,createdBy:this.project.createdBy};this._notebook.createNewNotebook(this.project._id,e).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{this.showSpinner=!1,t?(this._toaster.success("Notebook created successfully","Notebooks"),this.closeModal(t)):this._toaster.error("Cannot create new notebook","Notebooks")},t=>{this.showSpinner=!1,this._toaster.error("Server Error","Notebooks")})}closeModal(t){this._notebookDialogRef.close(t)}ngOnDestroy(){this.unsubscribe$.next(!1),this.unsubscribe$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(b.Nb(c.a),b.Nb(s.h),b.Nb(l.a),b.Nb(u.c),b.Nb(c.i),b.Nb(d.a),b.Nb(m))},t.\u0275cmp=b.Hb({type:t,selectors:[["app-notebook-dialog"]],decls:36,vars:12,consts:[["mat-dialog-title",""],[1,"mat-typography","mt-4"],["class","spinner",4,"ngIf"],["role","form","name","notebookForm",1,"form-validate",3,"formGroup"],[1,"row"],[1,"col-md-12","form-group"],["appearance","outline"],["for","fileName"],["matInput","","type","text","name","fileName","formControlName","fileName","id","fileName","placeholder","Enter notebook name","autocomplete","","required",""],[4,"ngIf"],[1,"col-md-6","form-group"],["formControlName","inputFiles","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","outputFileDataGroupId","required",""],[1,"mt-3","ml-1"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"justify-content-end","m-auto"],["mat-stroked-button","",3,"click"],["mat-flat-button","","type","submit",1,"btn-primary",3,"disabled","click"],[1,"spinner"],[3,"value"]],template:function(t,e){1&t&&(b.Tb(0,"h2",0),b.Kc(1,"Create New Notebook"),b.Sb(),b.Tb(2,"mat-dialog-content",1),b.Ic(3,_,1,0,"app-progress-spinner",2),b.Tb(4,"form",3),b.Tb(5,"div",4),b.Tb(6,"div",5),b.Tb(7,"mat-form-field",6),b.Tb(8,"mat-label",7),b.Kc(9,"Notebook name"),b.Sb(),b.Ob(10,"input",8),b.Ic(11,y,2,0,"mat-error",9),b.Ic(12,F,2,0,"mat-error",9),b.Sb(),b.Sb(),b.Sb(),b.Tb(13,"div",4),b.Tb(14,"div",10),b.Tb(15,"mat-form-field",6),b.Tb(16,"mat-label"),b.Kc(17,"Select input file"),b.Sb(),b.Tb(18,"mat-select",11),b.Ic(19,D,3,5,"mat-option",12),b.Sb(),b.Ic(20,B,2,0,"mat-error",9),b.Sb(),b.Sb(),b.Tb(21,"div",10),b.Tb(22,"mat-form-field",6),b.Tb(23,"mat-label"),b.Kc(24,"Select folder"),b.Sb(),b.Tb(25,"mat-select",13),b.Ic(26,O,2,2,"mat-option",12),b.Sb(),b.Ic(27,C,2,0,"mat-error",9),b.Sb(),b.Sb(),b.Sb(),b.Tb(28,"div",14),b.Tb(29,"mat-checkbox",15),b.ac("ngModelChange",(function(t){return e.addToPipeline=t})),b.Kc(30,"Add to pipeline"),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(31,"mat-dialog-actions",16),b.Tb(32,"button",17),b.ac("click",(function(){return e.closeModal()})),b.Kc(33,"Cancel"),b.Sb(),b.Tb(34,"button",18),b.ac("click",(function(){return e.onSubmitNotebook(e.notebookForm.value)})),b.Kc(35," Create "),b.Sb(),b.Sb()),2&t&&(b.Bb(3),b.kc("ngIf",e.showSpinner),b.Bb(1),b.kc("formGroup",e.notebookForm),b.Bb(7),b.kc("ngIf",e.notebookForm.get("fileName").hasError("required")&&(e.notebookForm.get("fileName").dirty||e.notebookForm.get("fileName").touched)),b.Bb(1),b.kc("ngIf",e.notebookForm.get("fileName").hasError("pattern")),b.Bb(7),b.kc("ngForOf",e.dialogData.dataSets),b.Bb(1),b.kc("ngIf",e.notebookForm.get("inputFiles").hasError("required")&&(e.notebookForm.get("inputFiles").dirty||e.notebookForm.get("inputFiles").touched)),b.Bb(6),b.kc("ngForOf",e.dialogData.dataGroups),b.Bb(1),b.kc("ngIf",e.notebookForm.get("outputFileDataGroupId").hasError("required")&&(e.notebookForm.get("outputFileDataGroupId").dirty||e.notebookForm.get("outputFileDataGroupId").touched)),b.Bb(2),b.kc("ngModel",e.addToPipeline)("ngModelOptions",b.mc(11,K)),b.Bb(5),b.kc("disabled",e.notebookForm.invalid))},directives:[c.j,c.g,f.t,s.K,s.v,s.m,k.c,k.g,g.b,s.d,s.u,s.k,s.F,S.a,f.s,w.b,s.x,c.d,N.b,I.a,k.b,v.o],pipes:[T.a],styles:[""]}),t})();var j=o("/mf7"),L=o("jhN1"),G=o("EiqI"),M=o("Wp6s"),x=o("NFeN"),A=o("Qu3c"),U=o("tyNb"),P=o("Dh3D"),R=o("M9IT");const q=["notebookPaginator"],E=["notebookSort"];function z(t,e){1&t&&(b.Tb(0,"mat-icon",12),b.Kc(1,"chevron_right"),b.Sb())}function H(t,e){if(1&t&&(b.Tb(0,"h3",13),b.Kc(1),b.Sb()),2&t){const t=b.ec();b.Bb(1),b.Lc(t.notebookName)}}function Q(t,e){if(1&t){const t=b.Ub();b.Tb(0,"button",14),b.ac("click",(function(){return b.wc(t),b.ec().openFormDialog()})),b.Kc(1," Create "),b.Sb()}}function X(t,e){if(1&t){const t=b.Ub();b.Tb(0,"h4",15),b.Kc(1," You don't have any notebook created yet, "),b.Tb(2,"a",16),b.ac("click",(function(){return b.wc(t),b.ec().openFormDialog()})),b.Kc(3,"create now."),b.Sb(),b.Sb()}}const V=function(){return["/project/data/dataconnection"]};function W(t,e){1&t&&(b.Tb(0,"h4",15),b.Kc(1," Please upload dataset to create a new notebook, "),b.Tb(2,"a",17),b.Kc(3,"upload now."),b.Sb(),b.Sb()),2&t&&(b.Bb(2),b.kc("routerLink",b.mc(1,V)))}function Y(t,e){1&t&&b.Ob(0,"app-progress-spinner",38)}function J(t,e){1&t&&b.Ob(0,"th",39)}function Z(t,e){if(1&t&&(b.Tb(0,"td",40),b.Kc(1),b.Sb()),2&t){const t=e.index;b.ec();const o=b.tc(26);b.Bb(1),b.Mc(" ",t+1+o.pageIndex*o.pageSize," ")}}function tt(t,e){1&t&&(b.Tb(0,"th",41),b.Kc(1,"Name"),b.Sb())}function et(t,e){if(1&t){const t=b.Ub();b.Tb(0,"td",42),b.ac("click",(function(){b.wc(t);const o=e.$implicit;return b.ec(2).openNotebook(o)})),b.Kc(1),b.Sb()}if(2&t){const t=e.$implicit;b.Bb(1),b.Mc(" ",t.fileName," ")}}function ot(t,e){1&t&&(b.Tb(0,"th",41),b.Kc(1,"Created At"),b.Sb())}function at(t,e){if(1&t&&(b.Tb(0,"td",40),b.Kc(1),b.fc(2,"date"),b.Sb()),2&t){const t=e.$implicit;b.Bb(1),b.Mc(" ",b.hc(2,1,t.createdAt,"medium")," ")}}function it(t,e){1&t&&(b.Tb(0,"th",39),b.Kc(1,"Actions"),b.Sb())}function rt(t,e){if(1&t){const t=b.Ub();b.Tb(0,"td",40),b.Tb(1,"div",43),b.Tb(2,"button",44),b.ac("click",(function(){b.wc(t);const o=e.$implicit;return b.ec(2).deleteHandler(o)})),b.Ob(3,"i",45),b.Sb(),b.Sb(),b.Sb()}}function nt(t,e){1&t&&b.Ob(0,"tr",46)}function st(t,e){1&t&&b.Ob(0,"tr",47)}function ct(t,e){if(1&t&&(b.Tb(0,"td",50),b.Kc(1),b.Sb()),2&t){b.ec(2);const t=b.tc(6);b.Bb(1),b.Mc(' No data matching the filter "',t.value,'" ')}}function bt(t,e){1&t&&(b.Tb(0,"td",50),b.Kc(1,"No data available in table"),b.Sb())}function lt(t,e){if(1&t&&(b.Tb(0,"tr",48),b.Ic(1,ct,2,1,"td",49),b.Ic(2,bt,2,0,"td",49),b.Sb()),2&t){b.ec();const t=b.tc(6);b.Bb(1),b.kc("ngIf",""!=t.value),b.Bb(1),b.kc("ngIf",""==t.value)}}function ut(t,e){if(1&t){const t=b.Ub();b.Tb(0,"mat-card",18),b.Tb(1,"mat-card-content"),b.Tb(2,"mat-form-field",19),b.Tb(3,"mat-label"),b.Kc(4,"Search"),b.Sb(),b.Tb(5,"input",20,21),b.ac("keyup",(function(e){return b.wc(t),b.ec().applyFilter(e)})),b.Sb(),b.Sb(),b.Ic(7,Y,1,0,"app-progress-spinner",22),b.Tb(8,"table",23,24),b.Rb(10,25),b.Ic(11,J,1,0,"th",26),b.Ic(12,Z,2,1,"td",27),b.Qb(),b.Rb(13,28),b.Ic(14,tt,2,0,"th",29),b.Ic(15,et,2,1,"td",30),b.Qb(),b.Rb(16,31),b.Ic(17,ot,2,0,"th",29),b.Ic(18,at,3,4,"td",27),b.Qb(),b.Rb(19,32),b.Ic(20,it,2,0,"th",26),b.Ic(21,rt,4,0,"td",27),b.Qb(),b.Ic(22,nt,1,0,"tr",33),b.Ic(23,st,1,0,"tr",34),b.Ic(24,lt,3,2,"tr",35),b.Sb(),b.Ob(25,"mat-paginator",36,37),b.Sb(),b.Sb()}if(2&t){const t=b.ec();b.Bb(7),b.kc("ngIf",t.showSpinner),b.Bb(1),b.kc("dataSource",t.dataSource),b.Bb(14),b.kc("matHeaderRowDef",t.displayedColumns),b.Bb(1),b.kc("matRowDefColumns",t.displayedColumns),b.Bb(2),b.kc("pageSizeOptions",t.pageSizeOptions)}}function dt(t,e){if(1&t&&(b.Tb(0,"mat-card",51),b.Tb(1,"mat-card-content"),b.Tb(2,"div",52),b.Ob(3,"iframe",53),b.Sb(),b.Sb(),b.Sb()),2&t){const t=b.ec();b.Bb(3),b.kc("src",t.safeUrl,b.yc)}}const pt=o("GUC0");let ht=(()=>{class t{constructor(t,e,o,a,n,s,c,b,l){this._toaster=t,this._localStorage=e,this._spinner=o,this._dialog=a,this._sanitizer=n,this._notebook=s,this._data=c,this._window=b,this._schedular=l,this.dataSource=new i.p,this.pageSizeOptions=[10,15,20],this.displayedColumns=[],this.unsubscribe$=new r.b,this.showSpinner=!1,this.showOverview=!1,this.project=this._localStorage.getItem("project"),this.user=this._localStorage.getItem("user"),this.displayedColumns=["srNo","notebookName","createdAt","actions"]}set paginator(t){this.dataSource.paginator=t}set sort(t){this.dataSource.sort=t}ngOnInit(){this._spinner.showSpinner(),this.getNotebooksList(),this.getDataGroupList(),this.getDataSetList()}getNotebooksList(){this._notebook.getAllNotebooks(this.project._id).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{this._spinner.stopSpinner(),t?(this.notebooksArray=t,this.dataSource.data=t,this.dataSource.paginator=this.paginator,console.log("\u{1f680} ~ this.sort",this.sort),this.dataSource.sort=this.sort,this.dataSource._updateChangeSubscription()):this._toaster.error("Cannot fetch notebooks","Notebooks")},t=>{this._spinner.stopSpinner(),this._toaster.error("Server Error","Notebooks")})}getDataGroupList(){this._data.getDataGroupsList(this.project._id).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{t&&(this.dataGroupList=t)},t=>{this._toaster.error("Server Error","Data Flows")})}getDataSetList(){this._data.getAllProjectDatas(this.project._id).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{t&&(this.dataSetList=t[0].filesList)},t=>{this._toaster.error("Server Error","Data Set")})}deleteHandler(t){pt({title:"Are you sure?",text:"You will not be able to recover this notebook!",icon:"warning",buttons:{cancel:{text:"Cancel",value:null,visible:!0,className:""},confirm:{text:"Yes, delete it!",value:!0,visible:!0,className:"bg-danger"}}}).then(e=>{e&&(this.showSpinner=!0,this._notebook.deleteNotebook(this.project._id,t._id,t.fileName).subscribe(e=>{e?(this.notebooksArray=this.notebooksArray.filter(e=>e._id!==t._id),this.dataSource.data=this.notebooksArray,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource._updateChangeSubscription(),this._toaster.success(t.fileName+" deleted successfully","Notebooks")):this._toaster.error("Cannot delete the notebook","Notebooks"),this.showSpinner=!1},t=>{this.showSpinner=!1,this._toaster.error("Server Error","Notebooks")}))})}openFormDialog(){this._dialog.open($,{minWidth:"50vw",data:{dataGroups:this.dataGroupList,dataSets:this.dataSetList}}).afterClosed().subscribe(t=>{t&&this.getNotebooksList()})}openNotebook(t){this.notebookName=t.fileName,this._spinner.showSpinner(),this.safeUrl=this._sanitizer.bypassSecurityTrustResourceUrl(`${t.url}${t.fileName}?uid=${this.project.createdBy}&pid=${this.project._id}`),this.showOverview=!0,this._spinner.stopSpinner()}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}ngOnDestroy(){this.unsubscribe$.next(!1),this.unsubscribe$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(b.Nb(u.c),b.Nb(d.a),b.Nb(j.a),b.Nb(c.c),b.Nb(L.b),b.Nb(m),b.Nb(l.a),b.Nb(Window),b.Nb(G.a))},t.\u0275cmp=b.Hb({type:t,selectors:[["app-notebook"]],viewQuery:function(t,e){var o;1&t&&(b.Oc(q,!0),b.Oc(E,!0)),2&t&&(b.sc(o=b.bc())&&(e.paginator=o.first),b.sc(o=b.bc())&&(e.sort=o.first))},decls:16,vars:9,consts:[[1,"fluid-container"],[1,"heading"],["mat-card-avatar",""],[1,"folder-icon"],[1,"align-items-center"],[3,"click"],["class","my-auto",4,"ngIf"],["class","breadcrumb-name",4,"ngIf"],["mat-raised-button","","matTooltip","Create notebook","class","btn-primary ml-auto",3,"click",4,"ngIf"],["class","text-center mt-5 font-weight-normal",4,"ngIf"],["class","notebook-listing mt-5 p-4",4,"ngIf"],["class","notebook-ui mt-5",4,"ngIf"],[1,"my-auto"],[1,"breadcrumb-name"],["mat-raised-button","","matTooltip","Create notebook",1,"btn-primary","ml-auto",3,"click"],[1,"text-center","mt-5","font-weight-normal"],["href","#",1,"text-decoration-none",3,"click"],["href","#",1,"text-decoration-none",3,"routerLink"],[1,"notebook-listing","mt-5","p-4"],[1,"search-input"],["matInput","",3,"keyup"],["input",""],["class","spinner",4,"ngIf"],["mat-table","","matSort","","matSortActive","createdAt","matSortDirection","desc","matSortDisableClear","",1,"mt-2",3,"dataSource"],["notebookSort","matSort"],["matColumnDef","srNo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","notebookName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","clickable",3,"click",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"mt-2",3,"pageSizeOptions"],["notebookPaginator",""],[1,"spinner"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"clickable",3,"click"],[1,"action-buttons","d-flex"],["matTooltip","Click to remove the notebook.","mat-icon-button","",1,"delete-button",3,"click"],[1,"fa","fa-trash"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["class","mat-cell","colspan","4",4,"ngIf"],["colspan","4",1,"mat-cell"],[1,"notebook-ui","mt-5"],[2,"height","100vh"],["height","100%","width","100%","frameborder","0",3,"src"]],template:function(t,e){1&t&&(b.Tb(0,"div",0),b.Tb(1,"mat-card",1),b.Tb(2,"mat-card-header"),b.Tb(3,"div",2),b.Tb(4,"mat-icon",3),b.Kc(5,"library_books"),b.Sb(),b.Sb(),b.Tb(6,"mat-card-title",4),b.Tb(7,"h3",5),b.ac("click",(function(){return e.showOverview=!1})),b.Kc(8," Notebooks "),b.Sb(),b.Ic(9,z,2,0,"mat-icon",6),b.Ic(10,H,2,1,"h3",7),b.Sb(),b.Ic(11,Q,2,0,"button",8),b.Sb(),b.Sb(),b.Ic(12,X,4,0,"h4",9),b.Ic(13,W,4,2,"h4",9),b.Ic(14,ut,27,5,"mat-card",10),b.Ic(15,dt,4,1,"mat-card",11),b.Sb()),2&t&&(b.Bb(7),b.Db(e.showOverview?"heading-with-breadcrumb":"heading-title"),b.Bb(2),b.kc("ngIf",e.showOverview),b.Bb(1),b.kc("ngIf",e.showOverview),b.Bb(1),b.kc("ngIf",!e.showOverview&&(null==e.dataSetList?null:e.dataSetList.length)),b.Bb(1),b.kc("ngIf",!e.dataSource.data.length&&!e.showOverview&&(null==e.dataSetList?null:e.dataSetList.length)),b.Bb(1),b.kc("ngIf",!(null!=e.dataSetList&&e.dataSetList.length)),b.Bb(1),b.kc("ngIf",!e.showOverview&&e.dataSource.data.length),b.Bb(1),b.kc("ngIf",e.safeUrl&&e.showOverview))},directives:[M.a,M.f,M.c,x.a,M.m,f.t,N.b,A.b,U.h,M.d,k.c,k.g,g.b,i.o,P.a,i.c,i.i,i.b,i.k,i.n,i.l,R.a,I.a,i.h,i.a,P.b,i.j,i.m],pipes:[f.f],styles:[".notebook-listing[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{cursor:pointer;color:#08509d!important}"]}),t})(),mt=(()=>{class t{}return t.\u0275mod=b.Lb({type:t}),t.\u0275inj=b.Kb({factory:function(e){return new(e||t)},imports:[[f.c,a.a,U.i.forChild([{path:"",component:ht}])]]}),t})()},"8NN1":function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var a=o("fXoL");let i=(()=>{class t{transform(t,e){return e&&t?t.substr(0,t.lastIndexOf(".")):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=a.Mb({name:"dropFileExtension",type:t,pure:!0}),t})()}}]);
//# sourceMappingURL=17-es2015.eeae60e5224756ca45eb.js.map