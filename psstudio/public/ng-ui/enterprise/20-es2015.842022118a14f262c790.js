(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{SZvS:function(t,e,a){"use strict";a.r(e),a.d(e,"FeatureRepoModule",(function(){return nt}));var r=a("PCNd"),i=a("3Pt+"),c=a("+0xr"),o=a("XNiG"),n=a("1G5W"),s=a("fXoL"),b=a("5eHb"),u=a("mLz/"),l=a("/mf7"),d=a("0IaG"),m=a("AytR"),h=a("tk/3");let f=(()=>{class t{constructor(t){this._http=t,this.serverBaseUrl=m.a.serverBaseUrl,this.formData=new FormData}getAllFeatures(t){return this._http.get(`${this.serverBaseUrl}/api/projects/${t}/feature_repo/share_features`)}deleteFeature(t,e){return this._http.put(`${this.serverBaseUrl}/api/projects/${t}/feature_repo/share_features`,e)}shareFeature(t,e,a){return this._http.post(`${this.serverBaseUrl}/api/projects/${t}/feature_repo/share_features/share?type=${e}`,a)}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(h.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=a("dNgK"),S=a("Wp6s"),g=a("NFeN"),T=a("ofXK"),F=a("kmnG"),v=a("qFsG"),I=a("Dh3D"),y=a("M9IT"),w=a("/3uh"),K=a("bTqV"),_=a("d3UM"),k=a("FKr1"),B=a("A5z7");const C=["featurePaginator"],D=["featureSort"];function N(t,e){1&t&&(s.Tb(0,"h4",9),s.Kc(1," You don't have any feature yet. "),s.Sb())}function O(t,e){1&t&&s.Ob(0,"app-progress-spinner",30)}function $(t,e){1&t&&s.Ob(0,"th",31)}function A(t,e){if(1&t&&(s.Tb(0,"td",32),s.Kc(1),s.Sb()),2&t){const t=e.index;s.Bb(1),s.Mc(" ",t+1," ")}}function R(t,e){1&t&&(s.Tb(0,"th",33),s.Kc(1,"Name"),s.Sb())}function j(t,e){if(1&t&&(s.Tb(0,"td",32),s.Kc(1),s.Sb()),2&t){const t=e.$implicit;s.Bb(1),s.Mc(" ",t.name," ")}}function L(t,e){1&t&&(s.Tb(0,"th",33),s.Kc(1,"Shared"),s.Sb())}function x(t,e){if(1&t&&(s.Tb(0,"td",32),s.Kc(1),s.Sb()),2&t){const t=e.$implicit;s.Bb(1),s.Mc(" ",t.isShared," ")}}function M(t,e){1&t&&(s.Tb(0,"th",33),s.Kc(1,"Created At"),s.Sb())}function U(t,e){if(1&t&&(s.Tb(0,"td",32),s.Kc(1),s.fc(2,"date"),s.Sb()),2&t){const t=e.$implicit;s.Bb(1),s.Mc(" ",s.hc(2,1,t.createdAt,"medium")," ")}}function q(t,e){1&t&&(s.Tb(0,"th",31),s.Kc(1,"Actions"),s.Sb())}function E(t,e){if(1&t){const t=s.Ub();s.Tb(0,"td",32),s.Tb(1,"div",34),s.Tb(2,"button",35),s.ac("click",(function(){s.wc(t);const a=e.$implicit,r=s.ec(2),i=s.tc(14);return r.openInfoDialog(a,i)})),s.Ob(3,"i",36),s.Sb(),s.Tb(4,"button",35),s.ac("click",(function(){s.wc(t);const a=e.$implicit,r=s.ec(2),i=s.tc(12);return r.openFormDialog(a,i)})),s.Ob(5,"i",37),s.Sb(),s.Tb(6,"button",38),s.ac("click",(function(){s.wc(t);const a=e.$implicit;return s.ec(2).deleteHandler(a)})),s.Ob(7,"i",39),s.Sb(),s.Sb(),s.Sb()}}function z(t,e){1&t&&s.Ob(0,"tr",40)}function G(t,e){1&t&&s.Ob(0,"tr",41)}function H(t,e){if(1&t&&(s.Tb(0,"td",44),s.Kc(1),s.Sb()),2&t){s.ec(2);const t=s.tc(6);s.Bb(1),s.Mc(' No data matching the filter "',t.value,'" ')}}function P(t,e){1&t&&(s.Tb(0,"td",44),s.Kc(1,"No data available in table"),s.Sb())}function Q(t,e){if(1&t&&(s.Tb(0,"tr",42),s.Ic(1,H,2,1,"td",43),s.Ic(2,P,2,0,"td",43),s.Sb()),2&t){s.ec();const t=s.tc(6);s.Bb(1),s.kc("ngIf",""!=t.value),s.Bb(1),s.kc("ngIf",""==t.value)}}function W(t,e){if(1&t){const t=s.Ub();s.Tb(0,"mat-card",10),s.Tb(1,"mat-card-content"),s.Tb(2,"mat-form-field",11),s.Tb(3,"mat-label"),s.Kc(4,"Search"),s.Sb(),s.Tb(5,"input",12,13),s.ac("keyup",(function(e){return s.wc(t),s.ec().applyFilter(e)})),s.Sb(),s.Sb(),s.Ic(7,O,1,0,"app-progress-spinner",14),s.Tb(8,"table",15,16),s.Rb(10,17),s.Ic(11,$,1,0,"th",18),s.Ic(12,A,2,1,"td",19),s.Qb(),s.Rb(13,20),s.Ic(14,R,2,0,"th",21),s.Ic(15,j,2,1,"td",19),s.Qb(),s.Rb(16,22),s.Ic(17,L,2,0,"th",21),s.Ic(18,x,2,1,"td",19),s.Qb(),s.Rb(19,23),s.Ic(20,M,2,0,"th",21),s.Ic(21,U,3,4,"td",19),s.Qb(),s.Rb(22,24),s.Ic(23,q,2,0,"th",18),s.Ic(24,E,8,0,"td",19),s.Qb(),s.Ic(25,z,1,0,"tr",25),s.Ic(26,G,1,0,"tr",26),s.Ic(27,Q,3,2,"tr",27),s.Sb(),s.Ob(28,"mat-paginator",28,29),s.Sb(),s.Sb()}if(2&t){const t=s.ec();s.Bb(7),s.kc("ngIf",t.showSpinner),s.Bb(1),s.kc("dataSource",t.dataSource),s.Bb(17),s.kc("matHeaderRowDef",t.displayedColumns),s.Bb(1),s.kc("matRowDefColumns",t.displayedColumns),s.Bb(2),s.kc("pageSizeOptions",t.pageSizeOptions)}}function J(t,e){if(1&t&&(s.Tb(0,"mat-option",59),s.Kc(1),s.Sb()),2&t){const t=e.$implicit;s.kc("value",t._id),s.Bb(1),s.Lc(t.name)}}function X(t,e){1&t&&(s.Tb(0,"mat-error"),s.Kc(1,"Feature is required."),s.Sb())}function Y(t,e){1&t&&(s.Tb(0,"mat-error"),s.Kc(1,"Email id is required."),s.Sb())}function V(t,e){1&t&&(s.Tb(0,"mat-error"),s.Kc(1,"Invalid email id."),s.Sb())}function Z(t,e){if(1&t){const t=s.Ub();s.Tb(0,"h2",45),s.Kc(1,"Share a Feature"),s.Sb(),s.Tb(2,"mat-dialog-content",46),s.Tb(3,"form",47),s.Tb(4,"div",48),s.Tb(5,"div",49),s.Tb(6,"mat-form-field",50),s.Tb(7,"mat-label"),s.Kc(8,"Select feature(s) to share"),s.Sb(),s.Tb(9,"mat-select",51),s.Ic(10,J,2,2,"mat-option",52),s.Sb(),s.Ic(11,X,2,0,"mat-error",53),s.Sb(),s.Sb(),s.Sb(),s.Tb(12,"div",48),s.Tb(13,"div",49),s.Tb(14,"mat-form-field",50),s.Tb(15,"mat-label",54),s.Kc(16,"Email"),s.Sb(),s.Ob(17,"input",55),s.Ic(18,Y,2,0,"mat-error",53),s.Ic(19,V,2,0,"mat-error",53),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(20,"mat-dialog-actions",56),s.Tb(21,"button",57),s.ac("click",(function(){return s.wc(t),s.ec().sharingForm.reset()})),s.Kc(22,"Cancel"),s.Sb(),s.Tb(23,"button",58),s.ac("click",(function(){s.wc(t);const e=s.ec();return e.onSubmitShare(e.sharingForm.value)})),s.Kc(24," Share "),s.Sb(),s.Sb()}if(2&t){const t=s.ec();s.Bb(3),s.kc("formGroup",t.sharingForm),s.Bb(7),s.kc("ngForOf",t.featuresArray),s.Bb(1),s.kc("ngIf",t.sharingForm.get("sharedFeatures").hasError("required")&&(t.sharingForm.get("sharedFeatures").dirty||t.sharingForm.get("sharedFeatures").touched)),s.Bb(7),s.kc("ngIf",t.sharingForm.get("email").hasError("required")&&(t.sharingForm.get("email").dirty||t.sharingForm.get("email").touched)),s.Bb(1),s.kc("ngIf",t.sharingForm.get("email").hasError("email")),s.Bb(4),s.kc("disabled",t.sharingForm.invalid)}}function tt(t,e){if(1&t&&(s.Tb(0,"div"),s.Tb(1,"h3"),s.Tb(2,"b"),s.Kc(3,"Description :"),s.Sb(),s.Kc(4),s.Sb(),s.Tb(5,"mat-chip-list"),s.Tb(6,"mat-chip"),s.Kc(7),s.Sb(),s.Sb(),s.Sb()),2&t){const t=s.ec(2);s.Bb(4),s.Mc(" ",t.selectedFeature.description,""),s.Bb(3),s.Lc(t.selectedFeature.functionDefinition)}}function et(t,e){if(1&t&&(s.Tb(0,"tr"),s.Tb(1,"td"),s.Kc(2),s.Sb(),s.Tb(3,"td"),s.Kc(4),s.Sb(),s.Tb(5,"td"),s.Kc(6),s.Sb(),s.Sb()),2&t){const t=e.$implicit;s.Bb(2),s.Lc(t.colName),s.Bb(2),s.Lc(t.dataType),s.Bb(2),s.Lc(t.aggregateStrategy)}}function at(t,e){if(1&t&&(s.Tb(0,"div"),s.Tb(1,"h3"),s.Kc(2,"Shared features details"),s.Sb(),s.Tb(3,"table",62),s.Tb(4,"thead"),s.Tb(5,"tr"),s.Tb(6,"th"),s.Kc(7,"Feature name"),s.Sb(),s.Tb(8,"th"),s.Kc(9,"Data type"),s.Sb(),s.Tb(10,"th"),s.Kc(11,"Aggregation strategy"),s.Sb(),s.Sb(),s.Sb(),s.Tb(12,"tbody"),s.Ic(13,et,7,3,"tr",63),s.Sb(),s.Sb(),s.Tb(14,"h3"),s.Tb(15,"b"),s.Kc(16,"Shared index columns :"),s.Sb(),s.Kc(17),s.Sb(),s.Sb()),2&t){const t=s.ec(2);s.Bb(13),s.kc("ngForOf",t.selectedFeature.sharedFeaturesList),s.Bb(4),s.Lc(t.selectedFeature.sharedIndex.toString())}}function rt(t,e){if(1&t&&(s.Tb(0,"h2",45),s.Kc(1),s.Sb(),s.Tb(2,"mat-dialog-content",60),s.Tb(3,"h3"),s.Tb(4,"b"),s.Kc(5,"Feature Name :"),s.Sb(),s.Kc(6),s.Sb(),s.Ic(7,tt,8,2,"div",53),s.Ic(8,at,18,2,"div",53),s.Sb(),s.Tb(9,"mat-dialog-actions",56),s.Tb(10,"button",61),s.Kc(11,"Ok"),s.Sb(),s.Sb()),2&t){const t=s.ec();s.Bb(1),s.Mc(" ","function"===t.selectedFeature.type?"Function":"Feature"," Details "),s.Bb(5),s.Mc(" ",t.selectedFeature.name,""),s.Bb(1),s.kc("ngIf","function"===t.selectedFeature.type),s.Bb(1),s.kc("ngIf","feature"===t.selectedFeature.type)}}const it=a("GUC0");let ct=(()=>{class t{constructor(t,e,a,r,n,s,b){this._toaster=t,this._localStorage=e,this._spinner=a,this._dialog=r,this._feature=n,this._fb=s,this._snackBar=b,this.dataSource=new c.p,this.pageSizeOptions=[10,15,20],this.displayedColumns=[],this.unsubscribe$=new o.b,this.showSpinner=!1,this.project=this._localStorage.getItem("project"),this.displayedColumns=["srNo","featureName","shared","createdAt","actions"],this.sharingForm=this._fb.group({sharedFeatures:["",i.I.required],email:["",[i.I.required,i.I.email]]})}set paginator(t){this.dataSource.paginator=t}set sort(t){this.dataSource.sort=t}ngOnInit(){this._spinner.showSpinner(),this.getFeaturesList()}getFeaturesList(){this._feature.getAllFeatures(this.project._id).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{this._spinner.stopSpinner(),t?(this.featuresArray=t,this.dataSource.data=t,this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort):this._toaster.error("Sorry! Cannot fetch features.","Features")},t=>{this._spinner.stopSpinner(),this._toaster.error("Server Error","Features")})}onSubmitShare(t){this._feature.shareFeature(this.project._id,this.selectedFeature.type,t).pipe(Object(n.a)(this.unsubscribe$)).subscribe(t=>{t?(this.getFeaturesList(),this._toaster.success("Feature(s) shared successfully.","Features")):this._toaster.error("Sorry! Cannot shiare features.","Features")},t=>{this._toaster.error("Server Error","Features")})}openFormDialog(t,e){this.selectedFeature=t,this._dialog.open(e,{minWidth:"50vw",maxWidth:"50vw"})}openInfoDialog(t,e){this.selectedFeature=t,this._dialog.open(e,{minWidth:"50vw",maxWidth:"50vw"})}deleteHandler(t){t.isShared?this._snackBar.open("Shared feature cannot be deleted.","OK",{horizontalPosition:"right",verticalPosition:"bottom"}):it({title:"Are you sure?",text:"You will not be able to recover this file!",icon:"warning",buttons:{cancel:{text:"Cancel",value:null,visible:!0,className:""},confirm:{text:"Yes, delete it!",value:!0,visible:!0,className:"bg-danger"}}}).then(e=>{e&&(this.showSpinner=!0,this._feature.deleteFeature(this.project._id,t).subscribe(e=>{e?(this.featuresArray=this.featuresArray.filter(e=>e._id!==t._id),this.dataSource.data=this.featuresArray,this.dataSource._updateChangeSubscription(),this._toaster.success(t.name+" deleted successfully.","Feature Repo")):this._toaster.error("Sorry! Cannot delete the feature.","Feature Repo"),this.showSpinner=!1},t=>{this.showSpinner=!1,this._toaster.error("Server Error","Feature Repo")}))})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}ngOnDestroy(){this.unsubscribe$.next(!1),this.unsubscribe$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(b.c),s.Nb(u.a),s.Nb(l.a),s.Nb(d.c),s.Nb(f),s.Nb(i.h),s.Nb(p.c))},t.\u0275cmp=s.Hb({type:t,selectors:[["app-feature-repo"]],viewQuery:function(t,e){var a;1&t&&(s.Oc(C,!0),s.Oc(D,!0)),2&t&&(s.sc(a=s.bc())&&(e.paginator=a.first),s.sc(a=s.bc())&&(e.sort=a.first))},decls:15,vars:2,consts:[[1,"fluid-container"],[1,"heading"],["mat-card-avatar",""],[1,"folder-icon"],[1,"heading-title"],["class","text-center mt-5 font-weight-normal",4,"ngIf"],["class","features-listing mt-5 p-4",4,"ngIf"],["shareFormTemplate",""],["infoTemplate",""],[1,"text-center","mt-5","font-weight-normal"],[1,"features-listing","mt-5","p-4"],[1,"search-input"],["matInput","",3,"keyup"],["input",""],["class","spinner",4,"ngIf"],["mat-table","","matSort","","matSortActive","createdAt","matSortDirection","desc","matSortDisableClear","",1,"mt-2",3,"dataSource"],["featureSort","matSort"],["matColumnDef","srNo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","featureName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","shared"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"mt-2",3,"pageSizeOptions"],["featurePaginator",""],[1,"spinner"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],[1,"action-buttons","d-flex"],["mat-icon-button","",3,"click"],[1,"fas","fa-info-circle"],[1,"fas","fa-share-alt"],["mat-icon-button","",1,"delete-button",3,"click"],[1,"fa","fa-trash"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["class","mat-cell","colspan","4",4,"ngIf"],["colspan","4",1,"mat-cell"],["mat-dialog-title",""],[1,"mat-typography","mt-4"],["role","form","name","sharingForm",1,"form-validate",3,"formGroup"],[1,"row"],[1,"col-md-12","form-group"],["appearance","outline"],["formControlName","sharedFeatures","multiple",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["for","email"],["matInput","","type","email","name","email","formControlName","email","id","configName","placeholder","Enter email id","autocomplete","","required",""],[1,"justify-content-end","m-auto"],["mat-stroked-button","","mat-dialog-close","",3,"click"],["mat-flat-button","","mat-dialog-close","","type","submit",1,"btn-primary",3,"disabled","click"],[3,"value"],[1,"mat-typography",2,"overflow","unset"],["mat-stroked-button","","mat-dialog-close",""],[1,"table","table-bordered","table-hover"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.Tb(1,"mat-card",1),s.Tb(2,"mat-card-header"),s.Tb(3,"div",2),s.Tb(4,"mat-icon",3),s.Kc(5,"summarize"),s.Sb(),s.Sb(),s.Tb(6,"mat-card-title"),s.Tb(7,"h3",4),s.Kc(8,"Features"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Ic(9,N,2,0,"h4",5),s.Ic(10,W,30,5,"mat-card",6),s.Sb(),s.Ic(11,Z,25,6,"ng-template",null,7,s.Jc),s.Ic(13,rt,12,4,"ng-template",null,8,s.Jc)),2&t&&(s.Bb(9),s.kc("ngIf",!e.dataSource.data.length),s.Bb(1),s.kc("ngIf",e.dataSource.data.length))},directives:[S.a,S.f,S.c,g.a,S.m,T.t,S.d,F.c,F.g,v.b,c.o,I.a,c.c,c.i,c.b,c.k,c.n,c.l,y.a,w.a,c.h,c.a,I.b,K.b,c.j,c.m,d.j,d.g,i.K,i.v,i.m,_.a,i.u,i.k,T.s,i.d,i.F,d.d,d.e,k.o,F.b,B.d,B.a],pipes:[T.f],styles:[""]}),t})();var ot=a("tyNb");let nt=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[T.c,r.a,ot.i.forChild([{path:"",component:ct}])]]}),t})()}}]);
//# sourceMappingURL=20-es2015.842022118a14f262c790.js.map